<!DOCTYPE html>

<html lang="zh">
<head>
    <meta charset="UTF-8">
    <!-- 设置视口，确保在移动设备上正确显示 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 网页标题，显示在浏览器标签上 -->
    <title>天宫空间站 - 互动虚拟漫游体验</title>
    <!-- 链接到CSS样式表 -->
    <link rel="stylesheet" href="css/style.css">
    <!-- 设置网站图标 -->
    <link rel="icon" href="images/ui/favicon.ico" type="image/x-icon">
    <!-- SEO描述，用于搜索引擎优化 -->
    <meta name="description" content="探索中国天宫空间站的互动虚拟漫游体验，参观天和核心舱、问天实验舱和梦天实验舱">
</head>
<body>
    <!-- 启动屏幕 - 用户首次访问时显示的欢迎界面 -->
    <div class="launch-screen" id="launchScreen">
        <!-- 加载动画，可以在js/main.js中控制显示/隐藏 -->
        <div class="loading-animation"></div>
        <h1>天宫空间站</h1>
        <p>360°互动虚拟漫游体验</p>
        <p>准备踏上探索中国空间站的奇妙旅程，通过这个互动体验，您将能够身临其境地参观天和核心舱、问天实验舱、梦天实验舱、神舟飞船、天舟货运飞船，了解中国航天员的工作与生活环境。</p>
        <!-- 开始按钮，点击后会播放介绍视频，然后显示主界面 -->
        <button class="start-btn" id="startBtn">开始探索</button>
    </div>

    <!-- 介绍视频容器 - 点击开始按钮后显示 -->
    <div class="intro-video-container" id="introVideoContainer" style="display: none;">
        <video id="introVideo" class="intro-video" width="100%" height="100%" style="object-fit: contain; max-width: 100%; max-height: 100%;">
            <!-- 视频文件地址：位于项目根目录下的videos文件夹中的tiangong-intro.mp4文件 -->
            <source src="videos/tiangong-intro.mp4" type="video/mp4">
            您的浏览器不支持视频标签。
        </video>
        <!-- 可选：添加跳过视频按钮 -->
        <button class="skip-video-btn" id="skipVideoBtn">跳过视频</button>
    </div>

    <!-- 主虚拟漫游容器 - 包含全景图和所有交互元素 -->
    <div class="virtual-tour-container">
        <!-- 全景图显示区域 - 背景图片会通过JavaScript动态设置 -->
        <div class="tour-view" id="tourView"></div>
        
        <!-- 交互热点会通过JavaScript动态添加到这里 -->
        
        <!-- 信息弹窗 - 点击热点时显示详细信息 -->
        <div class="info-popup" id="infoPopup">
            <!-- 关闭按钮 -->
            <button class="close-btn" id="closePopup">×</button>
            <!-- 弹窗标题，由JavaScript动态更新 -->
            <h3 id="popupTitle">信息标题</h3>
            <!-- 弹窗内容区域，由JavaScript动态更新 -->
            <div id="popupContent">
                <p>详细信息将显示在这里...</p>
            </div>
        </div>
        
        <!-- 导航控制 - 用于在全景图之间切换 -->
        <div class="nav-controls">
            <!-- 上一个全景图按钮 -->
            <button class="nav-btn" id="prevBtn">上一个</button>
            <!-- 下一个全景图按钮 -->
            <button class="nav-btn" id="nextBtn">下一个</button>
        </div>
        
        <!-- 全景导航点 - 显示当前模块中的全景图列表，由JavaScript动态生成 -->
        <div class="panorama-nav" id="panoramaNav"></div>
        
        <!-- 界面覆盖层 - 包含模块选择器和信息面板 -->
        <div class="interface-overlay">
            <!-- 模块选择器 - 用于切换不同的空间站舱段 -->
            <div class="overlay-element module-selector">
                <h4>选择模块</h4>
                <!-- 模块按钮，data-module属性用于JavaScript识别选择的模块 -->
                <!-- active类表示当前选中的模块 -->
                <button class="module-btn active" data-module="tianhe">天和核心舱</button>
                <button class="module-btn" data-module="wentian">问天实验舱</button>
                <button class="module-btn" data-module="mengtian">梦天实验舱</button>
                <button class="module-btn" data-module="shenzhou">神舟飞船</button>
                <button class="module-btn" data-module="tianzhou">天舟货运飞船</button>
            </div>
            
            <!-- 信息面板 - 显示当前位置和描述 -->
            <div class="overlay-element info-panel">
                <!-- 当前位置标题，由JavaScript动态更新 -->
                <h4 id="currentLocation">当前位置: 天和核心舱</h4>
                <!-- 位置描述，由JavaScript动态更新 -->
                <p id="locationDescription">中国空间站的管理与控制中心，为航天员提供生活区域和工作平台。</p>
            </div>
        </div>
    </div>


    <!-- 脚本文件 -->
    <!-- 先加载数据文件，因为main.js依赖于data.js中的数据 -->
    <script src="js/data.js"></script>
    <!-- 主要的JavaScript逻辑文件 -->
    <script src="js/main.js"></script>
    <!-- 视频播放相关的JavaScript代码 -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const startBtn = document.getElementById('startBtn');
            const launchScreen = document.getElementById('launchScreen');
            const introVideoContainer = document.getElementById('introVideoContainer');
            const introVideo = document.getElementById('introVideo');
            const skipVideoBtn = document.getElementById('skipVideoBtn');
            const virtualTourContainer = document.querySelector('.virtual-tour-container');

            
            // 初始状态下隐藏虚拟漫游界面
            virtualTourContainer.style.display = 'none';
            
            // 点击开始按钮
            startBtn.addEventListener('click', function() {
                // 隐藏启动屏幕
                launchScreen.style.display = 'none';
                // 显示视频容器
                introVideoContainer.style.display = 'block';
                // 播放视频
                introVideo.play();
                
                // 视频播放结束后显示主界面
                introVideo.addEventListener('ended', showMainInterface);
            });
            
            // 点击跳过视频按钮
            skipVideoBtn.addEventListener('click', function() {
                introVideo.pause();
                showMainInterface();
            });
            
            // 显示主界面函数
            function showMainInterface() {
                // 隐藏视频容器
                introVideoContainer.style.display = 'none';
                // 显示虚拟漫游界面
                virtualTourContainer.style.display = 'block';
                // 可能需要初始化虚拟漫游的代码，如果main.js中没有自动处理的话
            }
            
            // 窗口大小改变时调整视频尺寸
            window.addEventListener('resize', function() {
                if (introVideoContainer.style.display !== 'none') {
                    // 确保视频适应当前窗口大小
                    introVideo.style.maxWidth = window.innerWidth + 'px';
                    introVideo.style.maxHeight = window.innerHeight + 'px';
                }
            });
            
            // 初始化时设置视频尺寸
            introVideo.style.maxWidth = window.innerWidth + 'px';
            introVideo.style.maxHeight = window.innerHeight + 'px';
            
            // 模块介绍信息
            const moduleIntroductions = {
                tianhe: {
                    title: "天和核心舱概览",
                    content: "天和核心舱是中国空间站的主舱，承担着空间站的管理、控制与生命支持功能。它是空间站的指挥中心，配备了航天员的生活区和工作区。天和核心舱内设有多个科研设备，支持各类空间实验。它为航天员提供了充足的生活空间，并确保他们在微重力环境下能够完成任务。核心舱内还装有先进的环境控制系统，维持舱内温度、湿度、气压等条件，保障航天员的身心健康。此外，天和核心舱还负责航天员的长期生活支持，包括空气循环、饮用水供应、食品储存等方面的管理，确保空间站的日常运行和航天员的安全。",
                    buttonText: "了解详情"
                },
                wentian: {
                    title: "问天实验舱概览",
                    content: "问天实验舱是中国空间站的主要科研平台之一，专注于生命科学、材料科学等领域的实验。舱内配备了多种实验设备和高科技仪器，可以进行微重力环境下的科学研究。问天实验舱内有专门的生物实验区和材料科学实验区，用于探索植物、动物及材料在太空中的行为变化，推动科学进步。它支持航天员开展生物学、物理学等多学科的实验，研究微重力对生命体和物质的影响，为未来深空探测提供宝贵的实验数据。问天实验舱的设计与天和核心舱紧密配合，确保科学研究与空间站的运作不受干扰。",
                    buttonText: "了解详情"
                },
                mengtian: {
                    title: "梦天实验舱概览",
                    content: "梦天实验舱是中国空间站的重要实验舱之一，专注于微重力环境下的高端科学实验。它配备有先进的科研设备和舱外机械臂，支持进行精密的物理、光学等领域的实验。梦天实验舱内的设备可帮助航天员进行量子物理、精密光学、空间物理等复杂实验，推动现代科技的发展。该实验舱还设计了多个高精度实验区域，用于开展需要高度控制环境的实验。梦天实验舱的舱外平台可进行太空环境下的测试，为中国的航天技术和科学研究提供了不可或缺的支持。",
                    buttonText: "了解详情"
                },
                shenzhou: {
                    title: "神舟飞船概览",
                    content: "神舟飞船是中国的载人航天飞船，主要用于将航天员从地球送往空间站并返回。它由返回舱、轨道舱和推进舱组成，具备与空间站对接的能力，支持长时间在轨飞行。神舟飞船的返回舱是航天员的工作和生活区域，配备了完整的生命保障系统，确保航天员在飞行中的安全。轨道舱则提供了航天员进行短期科研的空间。推进舱包含飞船的动力系统，负责控制飞行姿态和轨道变换。神舟飞船不仅是中国航天员进入太空的重要工具，也是航天员与空间站之间的连接桥梁。",
                    buttonText: "了解详情"
                },
                tianzhou: {
                    title: "天舟货运飞船概览",
                    content: "天舟货运飞船是中国的货运飞船，主要用于将物资、设备和补给品送往空间站。它由货舱、推进舱和对接舱组成，具备与空间站对接的能力，支持长时间在轨飞行。天舟货运飞船的货舱是主要运输区域，配备了完善的货物存储和运输系统。推进舱包含飞船的动力系统，负责控制飞行姿态和轨道变换。天舟货运飞船不仅是中国空间站的重要后勤保障，也是航天员与地面之间的物资运输桥梁。",
                    buttonText: "了解详情"
                }
            };
            
            // 为所有模块按钮添加点击事件
            const moduleButtons = document.querySelectorAll('.module-btn');
            moduleButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const moduleType = this.getAttribute('data-module');
                    
                    // 显示模块总览弹窗
                    if (moduleIntroductions[moduleType]) {
                        const moduleInfo = moduleIntroductions[moduleType];
                        popupTitle.textContent = moduleInfo.title;
                        popupContent.innerHTML = `
                            <p>${moduleInfo.content}</p>
                            <button id="showDetailsBtn" class="nav-btn">${moduleInfo.buttonText}</button>
                        `;
                        
                        // 显示弹窗
                        infoPopup.classList.add('active');
                        
                        // 添加"了解详情"按钮点击事件
                        document.getElementById('showDetailsBtn').addEventListener('click', function() {
                            // 关闭当前弹窗
                            infoPopup.classList.remove('active');
                            
                            // 切换到相应模块并显示详细信息
                            // 这里假设switchModule函数在main.js中已定义
                            if (typeof switchModule === 'function') {
                                switchModule(moduleType);
                            }
                        });
                    }
                });
            });
            
            // 关闭弹窗按钮事件
            closePopup.addEventListener('click', function() {
                infoPopup.classList.remove('active');
            });
        });
    </script>

</body>

</html>